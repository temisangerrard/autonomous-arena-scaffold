Original prompt: yes there's a file called train world or so , thats the base world we will use so we can scaffold that in so we start seeing the game, dont forget various entry points required

- 2026-02-13: Started web scaffold work to integrate train world GLB as base world.
- Plan: add `/`, `/play`, `/viewer`, and world asset aliases so world loads immediately.
- Added world alias resolver and new web routes: `/`, `/play`, `/viewer`, `/api/worlds`, `/assets/world/:alias.glb`.
- Added front-end entry point pages and Three.js modules for viewer + playable third-person scaffold.
- Fixed runtime static/public path handling for both source and built server execution.
- Added import maps so `three/addons/*` modules resolve cleanly.
- Playwright smoke check passed with screenshot + state output at `/tmp/arena-playwright` and `worldLoaded: true`.
- TODO next: server-authoritative movement snapshots + websocket sync for real multiplayer.
- Motion inversion fix approach: moved play mode input simulation to server-authoritative input/snapshot flow over WebSocket.
- Added `apps/server/src/WorldSim.ts` and websocket gateway in server `index.ts`.
- Updated `play.js` to consume authoritative snapshots and use corrected +Z-forward input semantics.
- Added arrow-key aliases for automated input checks.
- Introduced server-authoritative movement over websocket (`/ws`), with snapshot tick loop at 20Hz.
- Added WorldSim tests for speed cap, bounds, and deceleration.
- Note: direct ad-hoc Playwright run in this environment can fail with WebGL context creation; the earlier skill-run screenshots remain valid for visual checks.
- Fixed play controls to camera-relative input vector projection (not board-locked).
- Added leg meshes + gait animation for local and remote avatars.
- Added HUD status updates for nearby/proximity counts and agent count.
- Added ChallengeService state machine (create/accept/decline/expire/resolve) with unit tests.
- Wired websocket challenge protocol:
  - client -> server: `challenge_send`, `challenge_response`
  - server -> client: `challenge` events (`created`, `accepted`, `declined`, `expired`, `resolved`, `invalid`, `busy`)
- Server enforces proximity for challenge initiation and one-active-challenge-per-player lock.
- Agent runtime now proactively sends/answers challenges based on personality.
- Web play UI now supports `C` (send), `Y/N` (accept/decline), and HUD challenge status text.
- Added server challenge log API: `/challenges/recent` and websocket `challenge_feed` broadcast.
- Added agent-runtime management APIs: `/agents/reconcile`, `/agents/:id/config`, `/secrets/openrouter`, `/capabilities/wallet`.
- Added dedicated `/agents` frontend panel for bot management and key/capability setup.
- Upgraded landing page `/` to an operational hub with links + live service/challenge telemetry.
- Attempted `npx skills coinbase/agentwallet`; command form invalid and direct repo clone path required auth.
- Installed Coinbase wallet skill pack via `npx skills add coinbase/agentic-wallet-skills --all -y` (9 skills installed).
- Added Super Agent module with deterministic delegation and wallet/LLM policy contracts.
- Added Super Agent APIs: `/super-agent/status`, `/super-agent/config`, `/super-agent/delegate/preview`, `/super-agent/delegate/apply`.
- Extended worker target preference with `human_only` to avoid agent-agent challenge loops by default.
- Updated `/agents` page with Super Agent controls and wallet-skill-aware defaults.
- 2026-02-13: Switched `/play` from stale inline demo logic to external `play.js` runtime wiring with real websocket gameplay.
- Added in-world Challenge Desk UI: target picker, game type (`rps` / `coinflip`), wager input, send/accept/decline actions, and RPS move buttons.
- Updated `play.js` challenge state handling to support `move_submitted`, active game status, and explicit per-game messaging.
- Updated agent bot behavior so runtime agents now submit RPS moves after challenge acceptance (not just looping movement/challenge requests).
- Rebuilt `apps/agent-runtime/src/index.ts` with super-agent-governed profile lifecycle:
  - create profile -> auto wallet + auto bot bundle
  - profile and wallet listing endpoints
  - wallet fund/withdraw/transfer/export-key actions
  - bot metadata (owner, display name, managed-by-super-agent) and config patching
  - background bot pool reconciliation separate from profile-owned bots
- Replaced `/agents` page with operations dashboard for:
  - super-agent policy controls
  - profile/bot/wallet bundle creation
  - wallet ops and key export
  - per-bot editing for personality/target/cooldown/super-agent management
- Fixed landing page challenge feed parser to use server `recent` log shape.
- Validation run:
  - `npm run lint` ✅
  - `npm test` ✅
  - `npm run typecheck` ✅
  - `npm run build` ✅
- Live smoke:
  - health endpoints at ports 3000/4000/4100 returned OK
  - created `profile_1` + `wallet_1` + `agent_profile_1`
  - enabled wallet policy and funded wallet via API
  - exported private key for owner-authorized profile
- TODO next:
  - integrate real on-chain wallet execution service (Coinbase skills as signed tx backend rather than in-memory balances)
  - connect `/agents` UI wallet actions to escrow contract flow once contracts are wired
  - add UI game renderer for non-trivial game types beyond RPS/coinflip (for visible active match scene)
- 2026-02-13: Fixed challenge-flow UX and identity clarity for live play.
- Server now captures websocket `name` metadata and includes `displayName` in snapshots/proximity/welcome payloads.
- Agent runtime now assigns random franchise-inspired names to bots (One Piece/DC/Marvel/Bleach pool) and sends names during agent websocket connect.
- Play page now renders floating nametags above avatars, label-aware target picker/messages, and a modal game flow that visibly transitions through sent/incoming/accepted/move_submitted/resolved states.
- Verified with synthetic websocket clients:
  - inbound agent challenges received quickly
  - accept -> move submit -> resolve path confirmed end-to-end for RPS.
- 2026-02-13: Added direct game controls for both game modes in play scene.
  - RPS controls: buttons + keyboard `1/2/3`
  - Coinflip controls: buttons + keyboard `H/T`
- Coinflip now requires explicit player/agent choices and resolves from coin toss against picks (not auto-roll on accept).
- Reduced in-world nametag footprint significantly (smaller canvas, font, sprite scale/offset).
- Updated policy engine with roam waypoints across 9 world regions; bots now spread and only hard-focus nearby targets.
- Changed super-agent default worker targeting to `human_first` to keep human interaction while enabling agent-vs-agent activity.
- Validation:
  - RPS end-to-end via websocket harness: created -> accepted -> move submit -> resolved ✅
  - Coinflip end-to-end via websocket harness: created -> accepted -> heads/tails -> resolved with toss result ✅
  - Agent spread sampling average ~80 world units (indicates regional exploration, not player clustering) ✅
- 2026-02-13: UX + behavior polish pass for user feedback.
- Reduced nametag size again (roughly 3x smaller area vs first version).
- Improved play challenge panel UX with key-hint pills and dedicated status line.
- Added deterministic spawn distribution in `WorldSim` using 8 section spawn anchors + jitter; agents no longer spawn around center.
- Updated agent pursuit/challenge targeting to avoid hard-locking on humans at long range and to rotate target selection.
- Set super-agent default worker target preference to `any` for healthier world activity.
- Validation:
  - health endpoints all OK
  - agent spatial spread probe avg ~199.6 world units
  - coinflip flow still resolves end-to-end after changes.
- 2026-02-13: Added bottom-right world map panel in play mode.
  - 8-section grid visualization (`S1..S8`), live local coordinates, and player dots (self/agent/human colors).
  - map updates every frame from authoritative snapshot positions.
- Reworked challenge feed UX from wall-of-text to structured event cards:
  - event type + timestamp + message body per item
  - dedupe guard for repeated identical events within 2s
  - capped history (14 items) and empty-state rendering
- Play HTML/CSS now includes map panel styles and card-based feed styles.
- 2026-02-13: Play HUD usability overhaul based on user feedback.
- Added centered `Match Controls` dock (bottom-center) with large, explicit action buttons:
  - incoming: Accept/Decline
  - active RPS: Rock/Paper/Scissors
  - active Coinflip: Heads/Tails
- Reduced visual load of top-left HUD (compact line only).
- Right challenge desk is now secondary support UI; core gameplay controls are no longer buried there.
- Terminal result still uses modal; active gameplay uses dock.
- 2026-02-13: Physics hardening pass in server authoritative world simulation.
- Added static obstacle colliders (section-centered AABB footprints), safe spawn relocation, and axis-separated collision movement.
- Added player-vs-player separation so avatars cannot overlap; includes velocity dampening on contact.
- Added test hooks for deterministic position setup in WorldSim tests.
- Expanded WorldSim tests:
  - overlap separation
  - obstacle blocking
  - existing speed/bounds/deceleration tests still passing.
- Live probe confirmed collision separation behavior (`minDist ~8.25` under converging input sequence).
- 2026-02-14: Escrow lifecycle hardening + visibility pass.
- Added escrow tx metadata and settlement history in runtime:
  - `EscrowLockRecord` now stores `lockTxHash`.
  - Added `EscrowSettlementRecord` ledger and `recentEscrowSettlements` in runtime status.
  - `/wallets/escrow/lock|resolve|refund` now return synthetic `txHash`; resolve returns `fee`/`payout`.
  - Added `/wallets/escrow/history?limit=` endpoint for recent settlement events.
- Server escrow adapter now preserves payload metadata (`txHash`, `fee`, `payout`).
- Game server now broadcasts explicit escrow phase events over websocket:
  - `challenge_escrow` with `phase=lock|resolve|refund`, `ok`, `reason`, and tx metadata.
- Play UI now renders escrow feed lines and surfaces lock failures in status messaging.
- Dashboard now includes `Escrow Activity` panel.
- Added web API proxy route: `/api/player/wallet/escrow-history` and dashboard wiring.
- Agent anti-loop challenge behavior upgraded:
  - per-target cooldown map
  - suppression backoff after invalid/busy/declined/expired outcomes
  - reduced repetitive targeting loops
- Validation:
  - typecheck: `@arena/agent-runtime`, `@arena/server`, `@arena/web` ✅
  - tests: `@arena/agent-runtime`, `@arena/server`, `@arena/web` ✅
  - playable smoke: challenge create -> accept -> move -> resolve ✅
- Playwright skill loop executed via `$WEB_GAME_CLIENT` against `/play`; run landed on auth-gated welcome route due unauthenticated session and captured expected auth-related console errors (`401/403`, Google origin restriction in local test context).
- TODO next:
  - wire real chain tx submission (replace synthetic tx hashes) from wallet execution service
  - add authenticated Playwright scenario for `/play` (local auth bootstrap cookie step before visit)
  - expose escrow state in admin/agents panel with filter by challengeId/player wallet
- 2026-02-14: Integrated ETHSkills into Super Agent knowledge + controls.
- Added Solidity/EVM-oriented capabilities into default super-agent wallet skill allowlist:
  - `solidity-contract-design`, `solidity-security-review`, `evm-gas-optimization`.
- Added live ETHSkills knowledge cache in runtime:
  - source list includes `https://ethskills.com/` plus topic pages (`why`, `gas`, `wallets`, `standards`, `tools`, `l2s`).
  - digest extractor stores title + summary + fetched timestamp.
  - cached digests are now included in super-agent brain status.
- Added runtime APIs:
  - `GET /super-agent/ethskills`
  - `POST /super-agent/ethskills/sync`
- Added super-agent chat command: `sync ethskills` (also matches refresh/update solidity/evm skills phrasing).
- OpenRouter super-agent prompt now includes ETHSkills digest context when available.
- Added admin UI control on `/agents`:
  - `Sync ETHSkills` button wired to runtime sync endpoint.
- Runtime now attempts ETHSkills sync at startup and persists cached entries in runtime state.
- Verification:
  - `curl -X POST /super-agent/ethskills/sync` returned `ok:true` with ETHSkills digest.
  - `@arena/agent-runtime` typecheck/test ✅
  - `@arena/web` typecheck/test ✅
- 2026-02-14: Continued real-build hardening with ETHSkills + optional onchain escrow adapter mode.
- Added ETHSkills ingestion for Super Agent:
  - sources now target explicit `.../SKILL.md` pages
  - markdown-aware digest extraction and runtime cache persistence
  - startup sync + manual sync command/endpoints
- New runtime endpoints:
  - `GET /super-agent/ethskills`
  - `POST /super-agent/ethskills/sync`
- Super-agent chat supports command: `sync ethskills`.
- OpenRouter advisory prompt now injects cached ETHSkills context.
- Added admin `/agents` button: `Sync ETHSkills`.
- Added optional server escrow onchain execution path in `EscrowAdapter`:
  - env-driven mode: `ESCROW_EXECUTION_MODE=runtime|onchain`
  - onchain calls `createBet/resolveBet/refundBet` against deployed `BettingEscrow` using resolver signer.
  - runtime mode remains default/fallback.
- Added new env docs for onchain escrow in `.env.example` + `README.md`.
- Validation:
  - typecheck: `@arena/server`, `@arena/agent-runtime`, `@arena/web` ✅
  - tests: `@arena/server`, `@arena/agent-runtime`, `@arena/web` ✅
  - health: 3000/4000/4100 all OK ✅
  - ETHSkills sync endpoint now refreshes 7 pages and returns parsed digests ✅
- 2026-02-14: Added operational onchain wallet prep path for escrow.
- Runtime (`@arena/agent-runtime`) now exposes internal endpoint:
  - `POST /wallets/onchain/prepare-escrow` (auth via `INTERNAL_SERVICE_TOKEN`)
  - prepares participant wallets for onchain escrow by:
    - resolving signer from encrypted private key
    - checking ERC20 balance + allowance
    - attempting `mint` when token supports open mint (mock tokens)
    - signing `approve(escrow, amount)` as needed
- Server escrow adapter (`@arena/server`) onchain mode now calls prepare endpoint before `createBet`.
- Added `ESCROW_TOKEN_ADDRESS` + `INTERNAL_SERVICE_TOKEN` env support/docs.
- Added optional onchain mode config in server adapter constructor.
- Validation:
  - typecheck: server/runtime/web ✅
  - tests: server/runtime/web ✅
  - playable smoke ✅
- 2026-02-14: Sepolia operational prep completed.
- Contracts workspace updated with `sepolia` network support (`SEPOLIA_RPC_URL`, `DEPLOYER_PRIVATE_KEY`).
- Deploy script now supports:
  - existing token (`ESCROW_TOKEN_ADDRESS`) OR deploying new `MockUSDC`
  - custom resolver (`ESCROW_RESOLVER_ADDRESS`), fee recipient (`ESCROW_FEE_RECIPIENT`), fee bps
  - output artifact `output/escrow-deploy-<network>.json`
- Added npm script: `deploy:sepolia` for contracts workspace.
- Hardened contracts tests against startup slowness (extended timeout setup).
- Runtime/server onchain preparation path now includes wallet-level ERC20 allowance setup before createBet.
- Remaining external dependency: user-provided Sepolia RPC + keys + target token/escrow addresses.
- 2026-02-14: Multiplayer scaffold hardening pass (Redis presence + stable reconnect ids).
- Server now supports optional Redis-backed presence registry (`REDIS_URL`) with TTL keys.
  - New endpoint: `GET /presence` and `GET /presence?id=<playerId>`.
  - New env knobs: `REDIS_URL`, `SERVER_INSTANCE_ID`, `PRESENCE_TTL_SECONDS`.
  - Presence is synced every ~500ms from world snapshot and removed on disconnect.
  - Rejoin restores last known position from presence store before spawn fallback.
- Web/play identity stability:
  - `/api/player/bootstrap` now includes `clientId` from authenticated profile.
  - Play WS now sends `clientId` and persists it in local storage, keeping stable player id across reconnect.
- Challenge + escrow signal cleanup:
  - Prevented unnecessary resolve/refund attempts when escrow lock never succeeded.
  - Added clearer prepare failure propagation (`reason` from runtime prepare endpoint).
- Arena UI signal/noise cleanup:
  - Feed now scoped to matches involving the local player.
  - Escrow feed ignores unrelated challenge ids.
- Validation:
  - typecheck: server/agent-runtime/web ✅
  - tests: server/web ✅
  - health + new `/presence` endpoint live ✅
- 2026-02-14: Added distributed challenge scaffolding for cross-node gameplay.
- New files:
  - `apps/server/src/DistributedBus.ts`
  - `apps/server/src/DistributedChallengeStore.ts`
- Server now:
  - tracks challenge owner server id in distributed store
  - acquires per-player distributed locks on challenge create
  - releases distributed locks on resolved/declined/expired
  - forwards challenge response/move commands to owner server when challenge is remote
  - sends direct per-player events via redis bus when recipient is on another node
- Snapshot/proximity loop now merges remote players from presence cache, enabling cross-node visibility/proximity checks.
- `WorldSim.joinPlayer` now accepts preferred spawn coordinates for reconnect restore.
- Validation:
  - server/web/agent-runtime typecheck ✅
  - server tests ✅
  - playable smoke ✅
  - live `/presence` endpoint ✅
- 2026-02-14: Extended distributed gameplay scaffold further.
- Added distributed challenge history storage (`arena:challenge:history`) with `/challenges/recent` reading redis-backed feed when available.
- Added server heartbeat + orphaned challenge failover expiry:
  - periodic `PresenceStore.heartbeatServer()` writes server-liveness keys
  - `expireOrphanedChallenges()` scans distributed challenge metas and auto-expires stale open challenges when owner server disappears past grace window
  - env knob: `CHALLENGE_ORPHAN_GRACE_MS`
- Added remote-player metadata fallback for displayName/wallet lookup via presence cache map.
- Distributed challenge status updates now carry serialized challenge state to support failover expiry notifications.
- 2026-02-14: Applied Arena Play UI Design System doc pass to gameplay HUD/layout.
- Updated `apps/web/public/play.html`:
  - Added Nintendo-style top bar (avatar/name/wallet/streak/menu ghost button).
  - Converted challenge desk into contextual bottom-left panel style.
  - Added bottom-center live toast feed container.
  - Minimap resized to 130x130 with hover expand to 260x260.
  - Added incoming challenge timer bar in modal.
  - Introduced doc color tokens (coral/peach/mint/lavender/gold/cream/dark) and matching component styling.
- Updated `apps/web/public/js/play.js`:
  - Top bar binding for profile display + wallet/streak counters.
  - Context panel visibility tied to state (nearby/incoming/in-match) instead of always-on desk.
  - Incoming challenge modal now opens with timer/progress behavior.
  - Toast feed entries now show status dots and cleaner event semantics.
  - Interaction prompt hotkey text aligned with doc style.
- Validation: web typecheck/tests and playable smoke all passing.

- Dashboard design system applied (left sidebar, card views, bot cards, modal bot editor, elevated Super Agent bar, wallet/settings panels, danger zone, responsive behavior) and wired to existing player APIs.
- Added `/api/player/wallet/export-key` endpoint in web server and dashboard action with confirmation + clipboard flow.
- Hid global auth shell on `/dashboard` to prevent duplicate navigation.

- Fixed dashboard wallet visibility: show wallet IDs + onchain addresses for player and bot cards; added player wallet directory panel and transfer labels with short addresses.
- Updated player API surface to include walletAddress in directory and bot wallet info in /api/player/me response.
- Replaced play top-right menu hard redirect with dropdown menu (Dashboard, Viewer, Logout).

- Wallet panel switched to onchain-first data source: added runtime `/wallets/:id/summary`, web `/api/player/wallet/summary`, dashboard now renders token/native balances and address from onchain summary when available.
- Wallet actions (`fund`, `transfer`, `withdraw`) now execute onchain ERC20 transactions when chain config is present, with sponsored gas top-ups from Super Agent gas funder.
- Play menu icon now opens in-game dropdown (Dashboard, Viewer, Logout) instead of redirect-only behavior.

- Fixed core play challenge-state bug: client now ignores challenge events that do not involve the local player (prevents unrelated matches from overwriting local active match + controls).
- Improved incoming challenge UX: added responding state and disabled accept/decline while response is in flight; clarified wager lock text on incoming modal.

- Implemented challenge counter-offer flow: new websocket message `challenge_counter`, atomic server-side decline+reverse-challenge creation, distributed bus forwarding, and incoming match controls now include wager counter input/button.

- 2026-02-15: Camera/movement control fix: decoupled camera orbit yaw from server-authoritative player yaw to stop "world spinning" during WASD; fixed mouse-drag orbit direction; initialize camera yaw from player yaw on first snapshot; added richer `render_game_to_text` output (cameraYaw + desiredMove + display coords) for automated movement verification.

- 2026-02-15: UI/UX Production Polish Pass - Step 1 (agent/ui-polish-step1 branch):
  - Goal: Simplify play.html UI with progressive disclosure and add onboarding tutorial
  - Based on design review: too many simultaneous UI panels overwhelming players
  - Approach: UI-only changes (HTML/CSS in /apps/web/public/), no server changes
  - Completed tasks:
    - [x] Simplify HUD - hide secondary panels by default, show contextually
    - [x] Add onboarding tutorial overlay for first-time players (5-step tutorial)
    - [x] Add toast notification system for game events
    - [x] Add accessibility improvements (ARIA labels, focus states, screen reader announcements)
    - [x] Add reduced motion support for accessibility
    - [x] Enhance mobile responsiveness
    - [x] Add visual polish (animations, transitions, improved color tokens)
  - Changes made:
    - play.html: Complete UI overhaul with progressive disclosure
      - Added onboarding tutorial overlay with 5 steps (welcome, movement, camera, challenges, games)
      - Simplified HUD with minimal top bar (avatar, name, wallet, streak, menu)
      - Challenge panel now hidden by default, shows contextually when nearby players
      - Added toast notification container
      - Added screen reader announcer element
      - Improved world loading overlay with spinning icon
      - Added match controls header with badge (incoming/active)
      - Added CSS variables for success/error/info/warning colors
      - Added prefers-reduced-motion media query
      - Added .sr-only class for screen reader only content
      - Improved focus-visible states for keyboard navigation
    - play.js: Added onboarding and toast systems
      - initOnboarding(): Shows tutorial for first-time players (checks localStorage)
      - showOnboardingStep(): Navigates between tutorial steps
      - completeOnboarding(): Marks tutorial as complete, shows welcome toast
      - showToast(): Creates toast notifications with auto-dismiss
      - announceForScreenReader(): Announces messages for screen readers
  - Branch: agent/ui-polish-step1 from commit 71c9b56ccfa6d6d0e06a216c584e590b1296bf62

- 2026-02-15: Refactoring modularization pass - continued from `refactor/modularization` branch work:
  - Extracted HTTP utilities to `apps/agent-runtime/src/lib/http.ts`
    - Contains: `setCorsHeaders()`, `readJsonBody()`, `sendJson()`, `SimpleRouter` class
  - Extracted crypto utilities to `apps/agent-runtime/src/lib/crypto.ts`
    - Contains: `encryptSecret()`, `decryptSecret()`, `hashString()`, `sha256()`, `newPrivateKey()`, `addressFromPrivateKey()`, `redactSecrets()`, `pseudoTxHash()`, `createInternalTokenFromKey()`
  - Created shared types package at `packages/shared/src/types/index.ts`
    - Contains: `Profile`, `WalletRecord`, `BotRecord`, `EscrowLockRecord`, `EscrowSettlementRecord`, `WalletDenied`, `EthSkillDigest`, `SuperAgentMemoryEntry`, `GameMove`, `Challenge`, `WorldSnapshot`, `ClientMessage`, `ServerMessage`, `PresenceEntry`, API helpers
  - Created route handlers in `apps/agent-runtime/src/routes/`
    - `profiles.ts` - Profile route handlers
    - `wallets.ts` - Wallet route handlers
    - `bots.ts` - Bot/agent route handlers
    - `superAgent.ts` - Super Agent route handlers
    - `index.ts` - Route module exports
  - Updated `packages/shared/src/index.ts` to re-export types
  - Validation:
    - typecheck: all packages ✅
    - tests: all packages ✅
    - build: all packages ✅

- 2026-02-15: Movement/Camera/Avatar UX Fix Pass (by Cline):
  - Branch: main (direct commits, no worktree)
  - Problem: User reported "movement and camera controls are impossible to use for exploration"
  - Root causes identified:
    1. Camera orbit blocked while moving (had to stop to adjust camera)
    2. Camera orbit required Shift+Right-click (unusual combination)
    3. Avatar had no front/back indication (no face, eyes, or orientation markers)
    4. Bots programmed to roam world edges where no assets exist
  - Phase 1 - Camera Controls (apps/web/public/js/play.js):
    - [x] Enabled right-click drag without Shift requirement
    - [x] Removed movement-blocking condition from camera orbit
    - [x] Added scroll-wheel zoom (2-15 unit range)
    - [x] Connected zoom distance to camera follow logic
  - Phase 2 - Avatar Design (apps/web/public/js/play.js):
    - [x] Added face with eyes (white spheres + black pupils) for front indication
    - [x] Added shoulder pads (darker spheres on left/right) for body orientation
    - [x] Added chest emblem (gold triangle pointing forward) as front marker
    - [x] Improved head shape (slightly flattened sphere for human-like appearance)
  - Phase 3 - Bot Roaming (apps/agent-runtime/src/PolicyEngine.ts):
    - [x] Moved ROAM_POINTS from world edges (±96) to central asset-rich areas:
      - Near train (center): (0,0), (-15,5), (15,-5)
      - Near castle (north-west): (-20,-45), (-10,-35), (-30,-40)
      - Near giant tree (north-east): (75,-35), (85,-25), (65,-45)
      - Near logs (south-east): (85,55), (95,65), (75,60)
      - Central plaza: (25,25), (-25,-25), (30,-30)
    - [x] Adjusted SECTION_CENTERS from world edges to central areas
  - Controls summary after fix:
    - Right-click + drag: Orbit camera
    - Scroll wheel: Zoom in/out
    - R key: Reset camera behind player
    - WASD: Movement (relative to camera direction)
  - Files modified:
    - apps/web/public/js/play.js
    - apps/agent-runtime/src/PolicyEngine.ts

- 2026-02-15: Auth + Product Loop Hardening (Codex):
  - Enforced authenticated gameplay entry points:
    - `/profile` legacy route removed (redirects to `/dashboard` / `/welcome`), Netlify redirect updated
    - Landing CTAs now route logged-out users to `/welcome` before play
    - `/dashboard` client now bounces to `/welcome` on `401/403`
  - One player == one character bot:
    - Additional bot creation disabled for players (owner bot is provisioned at profile creation)
  - Super Agent separation:
    - Ops Super Agent is admin-only (`/api/super-agent/chat` gated)
    - Added player-scoped "Chief of Staff" endpoint for wallet + bot tuning (`/api/player/chief/chat`)
  - WebSocket auth:
    - Added signed `wsAuth` tokens and server verification to prevent direct unauthenticated `/ws` connections
    - Added production startup checks requiring `GAME_WS_AUTH_SECRET`
  - House economy:
    - Introduced `system_house` wallet (house bank) and NPC wallet floors funded by the house (no magic refills)
    - Ops UI now includes house controls (floors, topups, manual transfers/refills)
  - Online/offline handoff:
    - Play client sends presence heartbeats; owner bot is parked while the player is online and restored when offline/TTL expires

- 2026-02-15: Comprehensive UX/Auth/Super Agent Polish Pass (by Cline):
  - Phase 1: Authentication Hardening
    - [x] Redesigned landing page (`index.html`) as marketing/sign-in page with hero section, features, and clear CTAs
    - [x] Verified server-side auth checks on all sensitive routes (already in place)
    - [x] Verified WebSocket authentication enforced with `GAME_WS_AUTH_SECRET`
  - Phase 2: Super Agent as Chief of Staff
    - [x] Confirmed player chief endpoint (`/api/player/chief/chat`) is properly scoped - no admin escalation
    - [x] Added `apps/agent-runtime/src/codebaseContext.ts` with architecture docs, data flows, common issues, troubleshooting guides
    - [x] Super Agent now has codebase awareness for better operator assistance
    - [x] Added house bank management endpoints: `/house/status`, `/house/transfer`, `/house/refill`, `/house/config`
  - Phase 3: Improved Landing Page
    - [x] Complete redesign as marketing page with hero section, features grid, and sign-in CTAs
    - [x] Removed all unauthenticated game interactions
    - [x] Clear separation between marketing content and authenticated features
  - Phase 4: Wallet UI/UX Improvements
    - [x] Redesigned wallet section with better visual hierarchy and gradient background
    - [x] Added gas indicator for onchain wallets (shows ETH balance when available)
    - [x] Added CSS for transaction history display
    - [x] Improved wallet action layout with fund/withdraw side by side
  - Phase 5: Character Controls & Bot Personality
    - [x] Verified camera and controls are well-implemented
    - [x] Added control hints panel (press `?` to toggle) showing all keyboard shortcuts
    - [x] Onboarding tutorial already covers movement, camera, challenges, and game moves
  - Phase 6: Game Flow Polish
    - [x] Verified match state indicators already implemented in `match-controls` component
    - [x] Verified interaction prompts show nearby player name and distance
    - [x] Verified win/loss feedback shown in game modal and toast notifications
  - Key files modified:
    - `apps/web/public/index.html` - Marketing landing page
    - `apps/web/public/dashboard.html` - Wallet UI improvements, gas indicator
    - `apps/web/public/js/dashboard.js` - Gas indicator support
    - `apps/web/public/play.html` - Control hints panel
    - `apps/web/public/js/play/input.js` - Keyboard handler for hints toggle
    - `apps/agent-runtime/src/codebaseContext.ts` - New file for Super Agent context
    - `apps/agent-runtime/src/index.ts` - Integrated codebase context into Super Agent prompts

- 2026-02-15: Agent runtime index routing refactor (Codex):
  - Replaced `apps/agent-runtime/src/index.ts` path-based `if` router with `SimpleRouter` dispatch.
  - Removed duplicated HTTP + crypto helpers in `index.ts` in favor of `apps/agent-runtime/src/lib/http.ts` and `apps/agent-runtime/src/lib/crypto.ts`.
  - Standardized shared runtime types to `@arena/shared` exports.
  - Validation: `npm run typecheck` ✅ (`npm run lint` ✅ for agent-runtime workspace)
